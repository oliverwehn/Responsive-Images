/*! Copyright (c) 2013 Oliver Wehn (http://www.oliverwehn.com)
  Licensed under MIT, GPL
 
  Version: 0.2.0
  
  Requires jQuery framework
 */;(function(e,t,n,r){var i="responsiveImages",s={respondToResize:false,respondToUpscaleOnly:true,useParentWidth:true,resolutionInterval:50,isMobile:false};e.responsiveImages=function(t,n,r){this.elements=t;this.options=e.extend({},s,n);this._defaults=s;this._name=i;this._callback=r;this.loading=0;this.window=this.getWindowSize();this.init(n)};e.responsiveImages.prototype.init=function(){this.updatePaths();if(this.options.respondToResize){var n=null;var r=this;e(t).on("resize orientationchange",function(){if(n!=
null)t.clearTimeout(n);n=t.setTimeout(function(){new_dimensions=r.getWindowSize();if(r.respondToUpscaleOnly&&new_dimensions.width>r.window.width||!r.respondToUpscaleOnly&&new_dimensions.width!=r.window.width)r.updatePaths();n=null},500)})}};e.responsiveImages.prototype.updatePaths=function(){var n=this;var i=n.options;var s=Math.round(t.devicePixelRatio)||1;if(typeof t.orientation!=r)swidth=Math.ceil((t.orientation==90||t.orientation==-90?screen.height:screen.width)/i.resolutionInterval)*i.resolutionInterval;
else swidth=Math.ceil(screen.width/i.resolutionInterval)*i.resolutionInterval;e(n.elements).filter("img").each(function(t,o){var u=e(o);var a=u.parent();var f=0;while(typeof a.css!=r&&a.css("display")!="block")a=a.parent();if(typeof a.width!=r)f=Math.ceil(a.width()/i.resolutionInterval)*i.resolutionInterval;if(f<u.width())f=Math.ceil(u.width()/i.resolutionInterval)*i.resolutionInterval;var l="";if(n.options.isMobile){if(!(l=u.data("mobile-src"))&&!(l=u.data("src"))){l=u.attr("data-mobile-src")||u.attr("src");
u.data("mobile-src",l)}u.addClass("mobile")}else{if(u.hasClass("mobile"))u.removeClass("mobile");if(!(l=u.data("src"))){l=u.attr("src");u.data("src",l)}}var c=u.data("width")||null;if(c==null||c!=null&&(f>0&&(i.useParentWidth&&f>c)||(f==0||!i.useParentWidth)&&swidth>c)){var h=n.getURL(l,{swidth:swidth,pwidth:f,pxratio:s});h+="?"+(new Date).getTime();var p=new Image;e(p).load(function(){console.log("Responsive Images: Finished loading image "+this.src+". "+n.loading+" to go!");var t=0;if(typeof this.naturalWidth!=
r)t=this.naturalWidth;else t=this.width;t=t/s;u.attr("src",e(this).attr("src")).data("width",t);n.loading--;if(n.loading==0&&typeof n._callback=="function"){n._callback.call(n.elements);console.log("Responsive Images: Callback was called.")}}).attr("src",h);n.loading++;console.log("Responsive Images: Initiated loading image "+n.loading+": "+h)}})};e.responsiveImages.prototype.getWindowSize=function(){var e=Math.abs(t.orientation);return{width:e==90?screen.height:screen.width,height:e==90?screen.width:
screen.height,orientation:t.orientation||0}};e.responsiveImages.prototype.getURL=function(e,t,n){var r=t.swidth||0,i=t.pwidth||0,s=t.pxratio||1;var o=e.replace(/(\.[a-z]+)$/,".s"+r+".p"+i+".r"+s+"$1");return o};e.responsiveImages.prototype.getHash=function(e){var t=0,n,r;if(e.length==0)return t;for(n=0;n<e.length;n++){r=e.charCodeAt(n);t=(t<<5)-t+r;t=t&t}if(t<0)t=t*-1;return t.toString(16)};e.fn[i]=function(t,n){if(typeof t!="string"){var r=e.data(this,"plugin_"+i);if(!r)e.data(this,"plugin_"+i,new e.responsiveImages(this,
t,n));return this}else if(typeof e.responsiveImages.prototype[t]==="function"){var s=Array.prototype.slice.call(arguments,1);return e.responsiveImages.prototype[t].apply(null,s)}else return null}})(jQuery,window,document);
